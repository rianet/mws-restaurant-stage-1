let restaurants,neighborhoods,cuisines;var map,markers=[];DBHelper._dbPromise=DBHelper.openDatabase(),fetchNeighborhoods=(()=>{self.neighborhoods=DBHelper.fetchNeighborhoods(),fillNeighborhoodsHTML()}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),fetchCuisines=(()=>{self.cuisines=DBHelper.fetchCuisines(),fillCuisinesHTML()}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),showCachedRestaurants()}),showCachedRestaurants=(()=>{DBHelper._dbPromise.then(e=>{e&&e.transaction("restaurants").objectStore("restaurants").getAll().then(e=>{e.length?(DBHelper.restaurantData=e,fetchCuisines(),fetchNeighborhoods(),updateRestaurants()):DBHelper.fetchRestaurants().then(()=>{fetchCuisines(),fetchNeighborhoods(),updateRestaurants()})})})}),updateRestaurants=(()=>{const e=getSelectedCusine(),t=getSelectedNeighborhood(),s=DBHelper.fetchRestaurantByCuisineAndNeighborhood(e,t);resetRestaurants(s),fillRestaurantsHTML()}),getSelectedCusine=(()=>{const e=document.getElementById("cuisines-select");return e[e.selectedIndex].value}),getSelectedNeighborhood=(()=>{const e=document.getElementById("neighborhoods-select");return e[e.selectedIndex].value}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");t.setAttribute("aria-label",`List of ${getSelectedCusine()} food within ${getSelectedNeighborhood()} neighborhood`),e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li"),s=document.createElement("picture"),n=DBHelper.imageUrlForRestaurant(e),a=document.createElement("source");a.type="image/webp",a.srcset=`${n}.webp`;const r=document.createElement("img");r.className="restaurant-img",r.alt=`Restaurant ${e.name}`,r.src=`${n}-800.jpg`,r.sizes="(max-width: 960px) 50vw, 100vw",r.srcset=[`${n}-400.jpg 400w`,`${n}-800.jpg 800w`],s.append(a),s.append(r),t.append(s);const o=document.createElement("h2");o.innerHTML=e.name,t.append(o);const l=document.createElement("p");l.innerHTML=e.neighborhood,t.append(l);const c=document.createElement("p");c.innerHTML=e.address,t.append(c);const i=document.createElement("a");return i.innerHTML="View Details",i.setAttribute("aria-label",`View restaurant ${e.name}`),i.href=DBHelper.urlForRestaurant(e),t.append(i),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})});